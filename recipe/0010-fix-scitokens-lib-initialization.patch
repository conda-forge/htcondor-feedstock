From 0dfb06615898edd6b3bc0d46f97bc9c7072aaab9 Mon Sep 17 00:00:00 2001
From: Jason Patton <jpatton@cs.wisc.edu>
Date: Fri, 16 Sep 2022 16:13:02 -0500
Subject: [PATCH 10/10] fix scitokens lib initialization

Fixes SciTokens initialization when not using dlopen.
Cherry-pick of https://github.com/htcondor/htcondor/pull/847
---
 src/condor_utils/condor_scitokens.cpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/condor_utils/condor_scitokens.cpp b/src/condor_utils/condor_scitokens.cpp
index e53aaba55d..11ba504ada 100644
--- a/src/condor_utils/condor_scitokens.cpp
+++ b/src/condor_utils/condor_scitokens.cpp
@@ -167,7 +167,7 @@ htcondor::init_scitokens()
 	scitoken_get_expiration_ptr = scitoken_get_expiration;
 	scitoken_get_claim_string_list_ptr = scitoken_get_claim_string_list;
 	scitoken_free_string_list_ptr = scitoken_free_string_list;
-	g_init_tried = true;
+	g_init_success = true;
 #else
 	dprintf(D_SECURITY, "SciTokens support is not compiled in.\n");
 	g_init_success = false;
@@ -177,6 +177,7 @@ htcondor::init_scitokens()
 	dprintf(D_SECURITY, "SciTokens is not supported on Windows.\n");
 	g_init_success = false;
 #endif
+	g_init_tried = true;
 	return g_init_success;
 }
 
-- 
2.37.0 (Apple Git-136)

